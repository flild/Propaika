@{
    var title = ViewData["Title"] as string ?? "PROPAIKA — Ремонт техники Apple";

    // Используем Context.Request, это работает везде
    var scheme = Context.Request.Scheme;
    var host = Context.Request.Host;
    var path = Context.Request.Path;
    var canonicalUrl = $"{scheme}://{host}{path}";
    var baseUrl = $"{scheme}://{host}";
}

<!DOCTYPE html>
<html lang="ru" data-bs-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="@ViewData["Description"]" />

    <link rel="canonical" href="@canonicalUrl" />

    <title>@title</title>

    <!-- Open Graph -->
    <meta property="og:title" content="@ViewData["Title"]" />
    <meta property="og:description" content="@ViewData["Description"]" />
    <meta property="og:url" content="@canonicalUrl" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="ru_RU" />
    @if (ViewData["OgImage"] != null)
    {
        <meta property="og:image" content="@ViewData["OgImage"]" />
    }

    <!-- Schema.org LocalBusiness -->
    <script type="application/ld+json">
        {
          "@@context": "https://schema.org",
          "@@type": "LocalBusiness",
          "name": "PROPAIKA",
          "image": "@($"{baseUrl}/img/logo.png")",
          "@@id": "@baseUrl",
          "url": "@baseUrl",
          "telephone": "+79219890269",
          "priceRange": "₽₽",
          "address": {
            "@@type": "PostalAddress",
            "streetAddress": "Московский проспект, 2/6, офис 205",
            "addressLocality": "Санкт-Петербург",
            "postalCode": "190031",
            "addressCountry": "RU"
          },
          "geo": {
            "@@type": "GeoCoordinates",
            "latitude": 59.926179,
            "longitude": 30.318240
          },
          "openingHoursSpecification": {
            "@@type": "OpeningHoursSpecification",
            "dayOfWeek": [
              "Monday",
              "Tuesday",
              "Wednesday",
              "Thursday",
              "Friday",
              "Saturday",
              "Sunday"
            ],
            "opens": "11:00",
            "closes": "20:00"
          },
          "sameAs": [
            "https://t.me/propaika16",
            "https://pikabu.ru/@@ProPaika"
          ]
        }
    </script>

    @await RenderSectionAsync("Head", required: false)

    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/lib/bootstrap-icons/font/bootstrap-icons.min.css" />
    <link rel="stylesheet" href="~/css/responsive.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

    <!-- Yandex.Metrika -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

        ym(XXXXXXXX, "init", {
             clickmap:true,
             trackLinks:true,
             accurateTrackBounce:true,
             webvisor:true
        });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/XXXXXXXX" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
</head>
<body class="d-flex flex-column min-vh-100 bg-body text-body">
    <header class="border-bottom mb-4 neon-border sticky-top" style="background-color: rgba(11, 12, 16, 0.95); backdrop-filter: blur(10px);">
        <nav class="navbar navbar-expand-lg navbar-dark container-xxl px-3 px-lg-0">
            <a class="navbar-brand fw-bold neon-text" asp-page="/Index" style="letter-spacing: 1px;">PROPAIKA</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="mainNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" asp-page="/Index">Главная</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">О нас</a></li>
                    <li class="nav-item"><a class="nav-link" asp-page="/Cases/Index">Кейсы</a></li>
                    <li class="nav-item"><a class="nav-link" asp-page="/Prices/Index">Цены</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#contacts">Контакты</a></li>
                </ul>
                <div class="d-flex align-items-center gap-3">
                    <a href="https://www.avito.ru/ВАШ_ПРОФИЛЬ" target="_blank" class="btn btn-outline-info btn-sm rounded-pill px-3">
                        Отзывы на Авито
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mb-5">
        @RenderBody()
    </main>

    <footer class="border-top py-5 mt-auto" style="background: rgba(11, 12, 16, 0.95); border-top: 1px solid rgba(0, 243, 255, 0.15) !important;">
        <div class="container">
            <div class="row gy-4">
                <div class="col-lg-4 col-md-12">
                    <a asp-page="/Index" class="d-inline-block text-decoration-none mb-3">
                        <span class="fs-4 fw-bold neon-text" style="letter-spacing: 1px;">PROPAIKA</span>
                    </a>
                    <p class="small text-secondary mb-3">
                        Профессиональный ремонт и пайка техники Apple в Санкт-Петербурге. Восстанавливаем то, что другие предлагают менять.
                    </p>
                    <div class="d-flex gap-3">
                        <a href="https://t.me/propaika16" target="_blank" class="social-link" aria-label="Telegram"><i class="bi bi-telegram"></i></a>
                        <a href="https://www.avito.ru/ВАШ_ПРОФИЛЬ" target="_blank" class="social-link" aria-label="Avito">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 200 60">
                                <circle cx="25" cy="30" r="22" />
                                <circle cx="75" cy="30" r="22" />
                                <circle cx="125" cy="30" r="22" />
                                <circle cx="175" cy="30" r="22" />
                            </svg>
                        </a>
                        <a href="https://pikabu.ru/@@ProPaika" target="_blank" class="social-link" aria-label="Pikabu"><i class="bi bi-cookie"></i></a>
                    </div>
                </div>

                <div class="col-lg-2 col-6">
                    <h5 class="text-white mb-3 fs-6 fw-bold text-uppercase" style="letter-spacing: 0.5px;">Меню</h5>
                    <ul class="list-unstyled mb-0 d-flex flex-column gap-2 small">
                        <li><a asp-page="/Index" class="footer-link">Главная</a></li>
                        <li><a asp-page="/Prices/Index" class="footer-link">Цены</a></li>
                        <li><a asp-page="/Cases/Index" class="footer-link">Кейсы</a></li>
                        <li><a href="/#contacts" class="footer-link">Контакты</a></li>
                    </ul>
                </div>

                <div class="col-lg-3 col-6">
                    <h5 class="text-white mb-3 fs-6 fw-bold text-uppercase" style="letter-spacing: 0.5px;">Услуги</h5>
                    <ul class="list-unstyled mb-0 d-flex flex-column gap-2 small">
                        <li><a href="#" class="footer-link">Ремонт MacBook</a></li>
                        <li><a href="#" class="footer-link">Ремонт iPhone</a></li>
                        <li><a href="#" class="footer-link">Ремонт iPad</a></li>
                        <li><a href="#" class="footer-link">Пайка BGA</a></li>
                    </ul>
                </div>

                <div class="col-lg-3 col-md-12">
                    <h5 class="text-white mb-3 fs-6 fw-bold text-uppercase" style="letter-spacing: 0.5px;">Контакты</h5>
                    <ul class="list-unstyled small text-secondary mb-0 d-flex flex-column gap-3">
                        <li class="d-flex align-items-start gap-2">
                            <i class="bi bi-geo-alt neon-text mt-1"></i>
                            <span>Санкт-Петербург,<br>Московский проспект, 2/6, офис 205</span>
                        </li>
                        <li class="d-flex align-items-center gap-2">
                            <i class="bi bi-telephone neon-text"></i>
                            <a href="tel:+79219890269" class="footer-link fw-bold">+7 (921) 989-02-69</a>
                        </li>
                        <li class="d-flex align-items-center gap-2">
                            <i class="bi bi-clock neon-text"></i>
                            <span>Ежедневно 11:00 — 20:00</span>
                        </li>
                    </ul>
                </div>
            </div>

            <hr class="my-4" style="border-color: rgba(255,255,255,0.08);">

            <div class="d-flex flex-column flex-md-row justify-content-between align-items-center small text-secondary gap-2">
                <div>
                    © @DateTime.Now.Year PROPAIKA. Все права защищены.
                    <span class="mx-2">|</span>
                    <a href="/privacy" class="footer-link text-secondary">Политика конфиденциальности</a>
                </div>
                <div>
                    Сделано с любовью к паяльнику <span class="neon-text">🔧</span>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/theme.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
